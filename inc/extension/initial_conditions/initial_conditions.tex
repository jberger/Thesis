%This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 3.0 United States License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/3.0/us/ or send a letter to Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.

\section{Determining Appropriate Initial Conditions} \label{sec:initial_conditions}
For a DTEM or UED apparatus, where the electron pulse is produced in a laser-driven photo-electron gun, the implementation of the AG model of Michalik and Sipe~\cite{michalik_analytic_2006} requires knowledge of the initial ($ t = 0 $) bunch parameters immediately after generation at the photocathode surface inside the acceleration region of the gun.
For the purposes of this thesis, we will make a simple approximation to the behavior of the gun in order to provide generic initial conditions for the electron pulse.

\subsection{A Simplistic Analytic Form} 

% transverse
Consider a single-photon photoemission process with a spatially cylindrically symmetric incident Gaussian laser beam with Gaussian temporal irradiance profile 
\begin{equation}\label{eq:laser_form}
I ( x , y , t ) = I_{0} \exp \left ( - \frac{ ( x^{2} +y^{2} ) }{ w^{2} } - \frac{ t^{ 2 } }{ \tau^{ 2 } } \right ) \punct{,}
\end{equation}
where $w$ is the half-width 1/e maximum (HW1/eM) of the spatial irradiance distribution, $\tau$ is the HW1/eM pulse duration and $I_{0}$ is the peak pulse irradiance incident on a flat metallic photocathode.
A laser pulse of this form has a temporal uncertainty $ \Delta t_{L} = \tau / \sqrt{2} $.

The initial transverse properties of the emitted electron beam are easily understood.
The electron pulse's initial spatial variance is simply
\begin{equation}
\sigma_{\smallT } ( 0 ) = ( \Delta x )^{2} = ( \Delta y)^{2} = \frac{ w^{2} }{ 2 } \punct{.}
\end{equation}
For spatially-uniform photoemission from a planar photocathode, from symmetry we have $ \gamma_{\smallT} ( 0 ) = 0 $; i.e., there is no initial transverse spatial momentum chirp across the electron bunch.
Finally, thanks to the careful analysis of Dowell and Schmerge~\cite{dowell_quantum_2009} (confirmed by Jensen \textit{et. al.}~\cite{jensen_emittance_2010}), we know that metallic photocathode's initial transverse momentum variance at $ t = 0 $ is given by
\begin{equation} \label{eq:jensen_eta}
  \eta_{ \smallT } ( 0 )  = (\Delta p_{\smallT})^2 \approx \frac{ m }{ 3 } ( \hbar \omega - \Phi ) \punct{,}
\end{equation}
in the limit where the maximum excess photoemission energy, $ \Delta E = \hbar \omega - \Phi $ is significantly greater than the thermal energy $ k_{B} T $ of the electrons in the photocathode -- a condition that is generally met in laser-driven DC photoelectron guns.
For completeness we note that for thermionic emission $\Delta p_{\smallT} = \sqrt{m k_B T_e}$ where $k_B$ is the Boltzmann constant and $T_e$ is the electron temperature~\cite{dowell_quantum_2009,jensen_emittance_2010}.

% longitudinal
In the longitudinal direction ($z$), the interplay between acceleration, $ a = e E_{DC}/m $, in the DC gun and the physics of the photoemission process determine the initial values of $\sigma_z$, the longitudinal spatial variance, and $\gamma_z$, the longitudinal momentum chirp, of an electron bunch.
Two limiting regimes for the initial longitudinal variances $ \sigma_{i} ( 0 ) $ are readily identified: (i) when the incident drive laser pulse duration is sufficiently long to ensure that the distance the electrons travel due to acceleration in $ E_{DC} $ over the laser pulse duration is much greater than the distance traveled by electrons moving with a constant velocity $ v_{max} = \sqrt{ 2 \Delta E / m } $, the maximum photoemission velocity, over the same time period; and (ii) the opposite regime for sufficiently short laser pulse durations.

% dc dominated
In the long-pulse regime, the DC field dominated case, we assume that the intrinsic velocity of the emitted electrons is negligible.
The emitted electrons travel an average distance $ \Delta z $, during the $ \Delta t_{ L } $ rms laser pulse duration given by,
\begin{equation}
  \sqrt{ \sigma_{ z } ( 0 ) } \approx \Delta z = \frac{ 1 }{ 2 } a ( \Delta t_{L} )^{ 2 }  = \frac{ e E_{ DC } \tau^{ 2 } }{ 4 m } \punct{.}
\end{equation}
By a similar logic, we can say that the `front' of the pulse then has a velocity equal to $ a \Delta t_{ L } $, while the `back' of the pulse (a distance $ \frac{ 1 }{ 2 } \sqrt{ \sigma_{ z } ( 0 ) } $ from the electron bunch peak) has zero velocity since it has just been generated. From this one sees that the initial linear chirp across the pulse is given by 
\begin{equation}
  \gamma_{ z } ( 0 ) \approx m \Delta v \Delta z = m a \Delta t_{ L } \sqrt{ \sigma_{ z } ( 0 ) } = \frac{ e E_{ DC } \tau }{ \sqrt{ 2 } }\sqrt{ \sigma_{ z } ( 0 ) } \punct{.}
\end{equation} 

%v0 dominated
In the short pulse limit, where the acceleration in the DC gun field over the incident laser pulse duration can be neglected, the initial electron bunch properties are determined primarily by the photoemission physics.
Since the electric field has no time to influence the front of the pulse before the back is also generated we can say that the front of the pulse has a velocity equal to $v_{max}$ and the back is essentially stationary just after generation.
Further, since the photoemission efficiency is proportional to $\Delta E^2$~\cite{shalaev_electron_1994} the distribution of emitted electrons vs velocity is proportional to $v^4$; therefore to a first approximation it is reasonable to say that in this case $\Delta v \approx v_{max}$.
The pulse's initial spatial variance $\Delta z$ is therefore approximately to the spread of distances traveled during the laser pulse duration $\Delta t_L$,
\begin{equation} 
  \sqrt{ \sigma_{ z } ( 0 ) } \approx \Delta z = \Delta v \Delta t_{L} = \frac{ v_{max} \tau }{ \sqrt{ 2 } } \punct{.}
\end{equation}
Once again, we can use this information to determine a velocity chirp across the pulse in this regime,
\begin{equation}
  \gamma_{ z } ( 0 ) \approx m \Delta v \Delta z = m v_{max} \sqrt{ \sigma_{ z } ( 0 ) } \punct{,}
\end{equation}

For simplicity of use, one may combine the initial conditions resulting from these two cases.
Since they arise from independent processes, the initial spatial uncertainties $\sigma_{ z } ( 0 )$ may be added naively 
\begin{equation} \label{eq:initial_sigma_z}
  \sigma_{ z } ( 0 ) \approx \frac{ ( v_{max} \tau )^{ 2 } }{ 2 } + \left ( \frac{ e E_{ DC } \tau^{ 2 } }{ 4 m } \right )^{ 2 } \punct{.}
\end{equation}
In the case of the initial momentum chirp terms $\gamma_{ z } ( 0 )$, while it is perhaps more rigorously correct to naively add  the terms with the spatial variance evaluated in each respective limit, we propose that the evaluation be done in terms of the resultant form presented in \ref{eq:initial_sigma_z}, keeping $\sigma_{z}$ unevaluated, 
\begin{equation}
  \gamma_{ z } ( 0 ) \approx \sqrt{ \sigma_{ z } ( 0 ) } \left ( m v_{max} + \frac{ e E_{DC} \tau }{ \sqrt{ 2 } } \right ) \punct{.}
\end{equation}
In this way the model may, in an intermediate case, more closely reflect the pulse length as modeled rather than the pulse length as idealized in each limiting case.

Finally, and again from a simplistic viewpoint, only the electrons generated with positive longitudinal momentum will contribute to the pulse since those electrons generated with negative momentum do not leave the photocathode.
This implies that the final initial condition, the local momentum uncertainty in the longitudinal direction $\eta_z$, is half that of the transverse directions; that is to say
\begin{equation}
  ( \Delta p_{ z } )^{2} = \left ( \frac{\Delta p_{ x , y }}{ 2 } \right )^{2} \punct{,}
\end{equation}
so that
\begin{equation}
  \eta_{ z } ( 0 ) \approx \frac{ \eta_{ \smallT } ( 0 )}{ 4 } \punct{,}
\end{equation}
which is certainly expected to be reasonably accurate in the short-pulse limit, where the acceleration has had no effect (see Section \ref{sec:bin_model} for further investigation).

In conclusion, the resulting set of analytic initial conditions for an incident Gaussian laser pulse of the form given in \ref{eq:laser_form} are
\begin{subequations} \label{eq:summary}
  \begin{gather}
    \sigma_{ \smallT } ( 0 ) \approx \frac{ w^{ 2 } }{ 2 } \\
    \sigma_{ z } ( 0 ) \approx \frac{ ( v_{max} \tau )^{ 2 } }{ 2 } + \left ( \frac{ e E_{ DC } \tau^{ 2 } }{ 4 m } \right )^{ 2 } \\
    \gamma_{ \smallT } ( 0 ) \approx 0 \\
    \gamma_{ z } ( 0 ) \approx \sqrt{ \sigma_{ z } ( 0 ) } \left ( m v_{max} + \frac{ e E_{DC} \tau }{ \sqrt{ 2 } } \right ) \\
    \eta_{ \smallT } ( 0 ) \approx \frac{ m }{ 3 } ( \hbar \omega - \Phi ) \\
    \eta_{ z } ( 0 ) \approx \frac{ \eta_{ \smallT } ( 0 ) }{ 4 } \punct{.}
  \end{gather}
\end{subequations}
Unless otherwise noted, these initial conditions will be used in all simulations for the remainder of this paper.

We recognize that these initial conditions for an electron pulse generated by a laser-driven DC gun are idealized in that they neglect several important effects; in particular, the interplay of dispersive ($ \eta_{i}(0) \neq 0 $) and space-charge effects in the acceleration region of the photoelectron gun and transverse and longitudinal effects due to the divergence of the DC field in the vicinity of the gun anode~\cite{berger_dc_2009,togawa_ceb6_2007}.
Such effects and the limits of the validity of the longitudinal terms of \ref{eq:summary}, within the context of the AG model, will be presented in Section \ref{sec:bin_model}.
However, \ref{eq:summary} also represents a defined set of initial conditions that allows the effect of electron optics (i.e., magnetic lenses and RF cavities) on electron pulse propagation to be more readily understood.
Moreover, they reflect the fact that the majority of DC photoelectron guns are driven by laser pulses with spatial and temporal profiles that are close to Gaussian~\cite{williamson_clocking_1997,sciaini_electronic_2009}.
Only for specialized cases, such as the generation of uniform ellipsoid electron bunch shapes, is spatial and temporal manipulation of the incident laser pulse considered~\cite{luiten_how_2004,li_generating_2008}.

\subsection{Iterative Spatial/Temporal Bin Model} \label{sec:bin_model}

To test the validity of the simplistic model presented above, I also developed a bin model that depends on nothing other than basic Newtonian kinematics and a simple quantum-mechanical ``transmission'' function over a barrier.
This function represents the likelihood of emission versus emission energy; the maximum energy being the full excess photoemission energy $\Delta E$.

In the model, the space in front of the photocathode is binned into segments in ranges of distance from the photocathode.
The total laser pulse duration is then binned into slices of time for a total duration of $N \tau$, a few times the HW1/eM duration $\tau$; $N$ is a number selected to accumulate enough of the total laser pulse for an accurate simulation.
In this notation the peak of the pulse occurs at time $N \tau / 2$.
For each slice of time, one can determine the relative number of electrons generated in that slice (normalized to the total number that will be created by the end of the simulation), and the velocity distribution of those electrons.
Knowing the remaining time in the simulation and the acceleration due to the electric field, the velocity distribution can be used to place these electrons into their final spatial bins (ignoring Coulomb repulsion on these short time scales).
Additionally, as the electrons are placed into these bins, their average velocity is stored as well.

This simulation repeats for each time slice until the finish time, at which point the laser has essentially stopped creating electrons.
At this time, the earliest fastest electrons will be a distance 
\begin{equation}
  z_{max} = v_{max}N \tau + \frac{e E_{ DC }}{2 m} (N \tau)^2 
\end{equation}
away from the the photocathode and the the electrons created in the last slice will be at $z=0$.
By counting the electrons in each spatial bin and fitting to a Gaussian, we can determine $\sigma_z(0)$, the initial longitudinal spatial variance of the pulse.
Taking a weighted average of the velocity of the electrons in each spatial bin and fitting to a linear function across the pulse (as defined by the AG model), we can determine the initial longitudinal velocity (momentum) chirp $\gamma_z(0)$.
As seen in \ref{fig:bin_model}, the shapes of the actual output compare well with the fitted functional form for both of these parameters for all reasonable ranges of field and laser pulse duration.

\input{bin_model_figure} %TODO do another run of this data, so I can have the run parameters

Finally, the velocity uncertainty in each bin can be computed, however, unlike the previous parameters, the AG model only allows for a constant value of $\eta_z(0)$, the local momentum variance across the pulse.
Unfortunately, \ref{fig:bin_model} clearly demonstrates that the local momentum variance is not constant over the initial photo-generated electron bunch; in fact it varies by almost an order of magnitude over the $ 1/e^{2} $ maximum full-width of the electron bunch. 
The narrowest momentum distribution are clearly at the front of the bunch where only the earliest generated electrons with initial velocity near $ v_{max} $ initially reside; the largest distribution is at the back where the last electrons generated still haven't had time to separate from one another.

This limitation on functional form severely limits the accuracy with which a determined spatially constant value of $\eta_z(0)$ represents the actual distribution of momentum uncertainties computed by the binning model.
The self-similar theory of Michalik and Sipe~\cite{michalik_analytic_2006} is not equipped to handle such a variation as it assumes a constant $ \eta_{ z } $ over the electron bunch; with a more realistic fit to the simulated initial data, the pulse would eventually evolve to be non-Gaussian.


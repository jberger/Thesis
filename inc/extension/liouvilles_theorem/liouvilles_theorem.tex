%This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 3.0 United States License. To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-nd/3.0/us/ or send a letter to Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA.

\section{Implications of Liouville's Theorem} \label{sec:liouville}

One of the most well known theorems in physics (and mathematics) is Liouville's Theorem.
This theorem can be summarized succinctly as a `the total phase space of a system is conserved.'
%TODO find a good reference for this
In the AG model the component phase-space products are simply $\sigma_{\alpha} \eta_{\alpha}$ where as before $ \alpha = \smallT, z$.

In fact it is easy to show that the AG model explicitly obeys the Liouville Theorem.
To do so, consider the time derivative of these component phase-space products.
Using \ref{eq:ag_original} it is easy to show that
\begin{equation}
  \frac{d}{dt} (\sigma_{\alpha} \eta_{\alpha}) = \sigma_{\alpha} \frac{d \eta_{\alpha}}{dt} + \eta_{\alpha} \frac{d \sigma_{\alpha}}{dt} = 0
\end{equation}
and therefore we can define the per-simulation constants $\Gamma_{\alpha}$ as
\begin{equation} \label{eq:define_big_gamma}
  \Gamma_{\alpha}^2 \equiv \sigma_{\alpha} \eta_{\alpha} = \text{Constant .}
\end{equation}

Not only is this an interesting result, but it can be both instructive and computationally useful.
By evaluating $\Gamma_{\alpha}$ at some time (presumably $t=0$) and rewriting \ref{eq:define_big_gamma} as $\eta_{\alpha} = \Gamma_{\alpha}^2 / \sigma_{\alpha}$, we can rewrite \ref{eq:ag_original} as 
\begin{subequations} \label{eq:ag_big_gamma}
\begin{gather}
  \frac{d\sigma_{\alpha}}{dt} = \frac{2\gamma_{\alpha}}{m} \\
  \frac{d\gamma_{\alpha}}{dt} = \frac{ \Gamma_{\alpha}^2 + \gamma_{\alpha}^2 }{\sigma_{\alpha} m}
    + \frac{N e^2}{4\pi\varepsilon_0} \frac{1}{6 \sqrt{\sigma_{\alpha}\pi}} L_{\alpha}(\xi) \, \text{.} \label{eq:ag_big_gamma_gamma}
\end{gather}
\end{subequations}
These four equations now contain all of the information previously contained in six (\ref{eq:ag_original}).
Having fewer equations, and fewer mathematical operations, makes this set of equations much less computationally intensive.
Further, when viewed in comparison to the chirps $\gamma_{\alpha}$, one can now see that these $\Gamma_{\alpha}$ constants can be thought of as some minimum/intrinsic action of the pulse.
This will become more apparent when, in future sections,
%TODO include internal reference
it is shown that at the focal point of a lens, $\gamma_{\alpha}$ goes through zero.

We note that, in the transverse directions ($\smallT$), this is consistent with the definition of `coherent fluence' employed by Reed et al.\cite{reed_evolution_2009} for time-resolved electron microscopy and, of course, the trasverse spatial emittance of an electron beam \cite{jensen_theoretical_2006,siwick_ultrafast_2002}.
%TODO include more commentary on $\varepsilon_{\smallT}$?
Additionally, though the AG model explicitly satisfies Liouville's Theorem, there are cases where the pulse's phase space product may change in a realistic system.
This effect is called ``emittance growth'' and is most commonly seen in TEM as a result of aberations in lens systems \cite{oshea_reversible_1998}.
As will be seen in Section \ref{extension_limitations}, the AG model will, of necessity, only consider perfect lenses.

